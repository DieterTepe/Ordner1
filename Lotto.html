<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lotto 6aus49 KI-Analyzer</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-matrix@1.1.0/dist/chartjs-chart-matrix.min.js"></script>
  <style>
    :root {
      --hot-color: #ff4444;
      --cold-color: #4285f4;
      --neutral-color: #4CAF50;
      --button-bg: #4CAF50;
      --button-hover: #45a049;
    }
    body {
      font-family: Arial, sans-serif;
      margin: 0; padding: 0;
      background-color: #f5f5f5;
    }
    .content-wrapper {
      padding: 20px; margin-bottom: 140px;
    }
    h1 {
      text-align: center; margin-top: 0; font-size: 1.5em;
    }
    #controls {
      display: flex; flex-direction: column; align-items: center;
      gap: 10px; margin-bottom: 20px;
    }
    select, input[type="file"], button {
      padding: 10px; font-size: 14px;
      border-radius: 5px; border: 1px solid #ccc;
    }
    button {
      background-color: var(--button-bg);
      color: white; border: none; cursor: pointer;
    }
    button:hover {
      background-color: var(--button-hover);
    }
    .number-container {
      display: flex; justify-content: center; flex-wrap: wrap;
      gap: 5px;
    }
    .number {
      display: inline-flex; align-items: center; justify-content: center;
      width: 32px; height: 32px;
      background: var(--neutral-color); color: white;
      border-radius: 50%; font-weight: bold;
    }
    .superzahl-display {
      background: #FFC107; color: #333;
    }
    .chart-container {
      margin-bottom: 30px;
    }
    canvas {
      background: white; border-radius: 8px; padding: 10px;
    }
    .heatmap-container {
      width: 100%; max-height: 600px; overflow: auto;
    }
    .advanced-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px; margin-top: 20px;
    }
    .stat-box {
      padding: 15px; background: #f8f9fa; border-radius: 8px;
      border-left: 4px solid var(--neutral-color);
    }
    .stat-box.hot {
      border-color: var(--hot-color);
    }
    #topNumbersFooter {
      position: fixed; bottom: 0; left: 0; right: 0;
      background: #e9e9e9; padding: 10px; text-align: center;
      border-top: 2px solid var(--neutral-color); z-index: 1000;
    }
    #topNumbersFooter h2 {
      margin: 0 0 5px 0; font-size: 0.9em;
    }
    @media (max-width: 480px) {
      .number { width: 28px; height: 28px; font-size: 13px; }
    }
    .dieter-weights-box {
      background: #e7f3e7;
      border-radius: 8px;
      padding: 12px 15px 10px 15px;
      margin: 10px 0 15px 0;
      box-shadow: 0 1px 3px rgba(76,175,80,0.07);
      max-width: 600px;
      margin-left: auto; margin-right: auto;
    }
    .dieter-weights-box label {
      margin-right: 8px;
      font-weight: bold;
    }
    .dieter-weights-box input[type="number"] {
      width: 60px;
      margin-right: 18px;
      border-radius: 4px;
      border: 1px solid #bbb;
      padding: 3px 7px;
    }
    .dieter-weights-box span {
      margin-right: 18px;
    }
    /* NEU: Style für Backtest-Box */
    .dieter-backtest-box {
      background: #fffbe7;
      border-radius: 8px;
      padding: 12px 15px 10px 15px;
      margin: 10px 0 15px 0;
      box-shadow: 0 1px 3px rgba(255,193,7,0.08);
      max-width: 600px;
      margin-left: auto; margin-right: auto;
    }
    .dieter-backtest-box h3 {
      margin-top: 0;
      margin-bottom: 7px;
      font-size: 1.1em;
    }
    .dieter-backtest-results table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 5px;
      font-size: 0.96em;
    }
    .dieter-backtest-results th, .dieter-backtest-results td {
      padding: 3px 6px;
      border-bottom: 1px solid #eee;
      text-align: center;
    }
    .dieter-backtest-results th {
      background: #fff6c1;
    }
    .dieter-backtest-results .right {
      color: var(--hot-color); font-weight: bold;
    }
    .dieter-backtest-results .zero {
      color: #bbb;
    }
  </style>
</head>
<body>
  <div class="content-wrapper">
    <h1>Lotto 6aus49 KI-Analyzer</h1>
    <div id="controls">
      <button id="githubBtn">Daten von GitHub laden</button>
      <input type="file" id="fileInput" accept=".json" />
      <select id="dataSubsetSelect">
        <option value="all">Alle Ziehungen verwenden</option>
        <option value="3000">Letzte 3000 Ziehungen</option>
        <option value="2000">Letzte 2000 Ziehungen</option>
        <option value="1000">Letzte 1000 Ziehungen</option>
        <option value="500">Letzte 500 Ziehungen</option>
        <option value="100">Letzte 100 Ziehungen</option>
        <option value="50">Letzte 50 Ziehungen</option>
        <option value="25">Letzte 25 Ziehungen</option>
        <option value="10">Letzte 10 Ziehungen</option>
      </select>
      <button id="analyzeBtn" disabled>Analyse starten</button>
      <div id="loadingStatus" class="loading-message" style="display: none; color: #888;"></div>
    </div>

    <!-- Dieter-Prognose Gewichtungs-Einstellungen -->
    <div class="dieter-weights-box">
      <strong>Dieter-Prognose Gewichtung:</strong><br>
      <span>
        <label for="weightLong">Alle Ziehungen:</label>
        <input type="number" id="weightLong" value="31.2" min="0" step="0.1">
      </span>
      <span>
        <label for="weight1000">Letzte 1000:</label>
        <input type="number" id="weight1000" value="9.75" min="0" step="0.1">
      </span>
      <span>
        <label for="weight100">Letzte 100:</label>
        <input type="number" id="weight100" value="0.5" min="0" step="0.1">
      </span>
      <span>
        <label for="weight25">Letzte 25:</label>
        <input type="number" id="weight25" value="0.34" min="0" step="0.1">
      </span>
    </div>
    <!-- NEU: Dieter-Prognose Backtest-Ergebnis -->
    <div class="dieter-backtest-box">
      <h3>Backtest: Dieter-Prognose auf die letzten 50 Ziehungen</h3>
      <div id="dieterBacktestResults" class="dieter-backtest-results">Noch keine Auswertung.</div>
      <button id="btnRunDieterBacktest" style="margin-top:10px;">Backtest jetzt ausführen</button>
    </div>
    <div class="chart-container">
      <h3>Häufigkeit Lottozahlen (1–49)</h3>
      <canvas id="freqChart" width="600" height="300"></canvas>
    </div>

    <div class="chart-container">
      <h3>Häufigkeit Superzahlen (0–9)</h3>
      <canvas id="superzahlFreqChart" width="600" height="300"></canvas>
    </div>

    <div class="advanced-stats">
      <div class="stat-box" id="chiSquareResult">
        <h3>Chi-Quadrat-Test</h3>
        <p>Lädt...</p>
      </div>
      <div class="stat-box" id="hotColdInfo">
        <h3>Hot/Cold-Zahlen</h3>
        <div id="hotColdNumbers" class="number-container"></div>
      </div>
      <div class="stat-box">
        <h3>Entropie (Lottozahlen)</h3>
        <canvas id="entropyGauge" width="300" height="150"></canvas>
      </div>
    </div>

    <div class="chart-container">
      <h3>Übergangswahrscheinlichkeiten (Heatmap)</h3>
      <div class="heatmap-container">
        <canvas id="transitionHeatmap" width="600" height="600"></canvas>
      </div>
    </div>

    <div class="advanced-stats">
      <div class="stat-box">
        <h3>KI-basierte Vorhersage</h3>
        <p>Diese Zahlen kombinieren Häufigkeit, Trends, Entropie & Übergänge:</p>
        <div id="kiTopNumbers" class="number-container"></div>
      </div>
      <div class="stat-box" style="max-height: 200px; overflow-y: auto;">
        <h3>Dieter-Prognose (Mehr-Ebenen-Analyse)</h3>
        <p>Langzeit-Defizit + Kurzfrist-Filter + KI-Gewichtung + Gewichtungseinstellungen:</p>
        <div id="dieterPrognoseList" class="number-container"></div>
      </div>
    </div>

    <div id="topNumbersFooter">
      <div class="top-section">
        <h2>Top 6 Lottozahlen</h2>
        <div id="topLottozahlenList" class="number-container"></div>
      </div>
      <div class="top-section">
        <h2>Top Superzahl</h2>
        <div id="topSuperzahlList" class="number-container"></div>
      </div>
    </div>
    <script>
      // Globale Gewichtungen für die Dieter-Prognose
      let DIETER_WEIGHT_LONG = 31.2;    // alle Ziehungen
      let DIETER_WEIGHT_1000 = 9.75;     // letzte 1000 Ziehungen
      let DIETER_WEIGHT_100  = 0.5;   // letzte 100 Ziehungen
      let DIETER_WEIGHT_25   = 0.34;   // letzte 25 Ziehungen

      // Funktion zum Aktualisieren der globalen Gewichte (durch UI)
      function updateDieterWeightsFromUI() {
        DIETER_WEIGHT_LONG  = parseFloat(document.getElementById('weightLong').value) || 0;
        DIETER_WEIGHT_1000 = parseFloat(document.getElementById('weight1000').value) || 0;
        DIETER_WEIGHT_100  = parseFloat(document.getElementById('weight100').value) || 0;
        DIETER_WEIGHT_25   = parseFloat(document.getElementById('weight25').value) || 0;
      }
      ['weightLong','weight1000','weight100','weight25'].forEach(id => {
        document.addEventListener('DOMContentLoaded', () => {
          document.getElementById(id).addEventListener('input', updateDieterWeightsFromUI);
        });
      });

      const GITHUB_URL = "https://raw.githubusercontent.com/JohannesFriedrich/LottoNumberArchive/d05706802ffbfc20d02f708d482c0d2066938356/Lottonumbers_complete.json";
      let allLottoEntries = [], chartInstances = {}, transitionMatrix = [], chiSquareResult = 0, expectedFrequency = 0, hotColdMap = [], entropyChart;

      window.addEventListener('load', () => loadGitHubJson());
      document.getElementById('githubBtn').addEventListener('click', loadGitHubJson);
      document.getElementById('fileInput').addEventListener('change', handleFileInput);
      document.getElementById('analyzeBtn').addEventListener('click', performAnalysis);

      // NEU: Backtest-Button Event-Handler
      document.addEventListener('DOMContentLoaded', () => {
        const btnBacktest = document.getElementById('btnRunDieterBacktest');
        if (btnBacktest) btnBacktest.addEventListener('click', runDieterBacktest);
      });

      function showLoadingMessage(msg) {
        const el = document.getElementById('loadingStatus');
        el.textContent = msg; el.style.display = 'block';
      }
      function hideLoadingMessage() {
        document.getElementById('loadingStatus').style.display = 'none';
      }

      async function loadGitHubJson() {
        document.getElementById('analyzeBtn').disabled = true;
        showLoadingMessage("Lade Daten von GitHub...");
        try {
          const res = await fetch(GITHUB_URL);
          if (!res.ok) throw new Error(res.status);
          const json = await res.json();
          validateAndProcessData(json, "GitHub");
        } catch (err) { handleError("Ladefehler: ", err); }
        finally { hideLoadingMessage(); }
      }

      function handleFileInput(e) {
        const file = e.target.files[0]; if (!file) return;
        showLoadingMessage("Verarbeite Datei...");
        const reader = new FileReader();
        reader.onload = evt => {
          try {
            const json = JSON.parse(evt.target.result);
            validateAndProcessData(json, "Datei");
          } catch (err) { handleError("Parsefehler: ", err); }
          finally { hideLoadingMessage(); }
        };
        reader.readAsText(file);
      }

      function validateAndProcessData(json, source) {
        if (!json || !Array.isArray(json.data)) throw new Error("Struktur");
        allLottoEntries = json.data;
        if (!allLottoEntries.length) throw new Error("Keine Daten");
        document.getElementById('analyzeBtn').disabled = false;
        alert(`Daten von ${source} geladen: ${allLottoEntries.length} Ziehungen.`);
      }

      function computeEntropy(freqs) {
        const total = freqs.reduce((a,b) => a+b, 0);
        return freqs.reduce((sum,c) => c===0 ? sum : sum - (c/total)*Math.log2(c/total), 0);
      }
      function renderEntropyGauge(entropy) {
        const ctx = document.getElementById('entropyGauge').getContext('2d');
        if (chartInstances.entropyGauge) chartInstances.entropyGauge.destroy();
        const maxEntropy = Math.log2(49);
        chartInstances.entropyGauge = new Chart(ctx, {
          type: 'doughnut',
          data: {
            labels: ['Entropie', 'Rest'],
            datasets: [{
              data: [entropy, maxEntropy - entropy],
              backgroundColor: ['#4CAF50', '#e0e0e0']
            }]
          },
          options: {
            responsive: true,
            cutout: '70%',
            rotation: 270,
            circumference: 180,
            plugins: {
              legend: { display: true, position: 'bottom' },
              title: {
                display: true,
                text: `Entropie: ${entropy.toFixed(2)} / ${maxEntropy.toFixed(2)}`
              }
            }
          }
        });
      }
      function classifyHotColdNumbers(freqs) {
        const mean = freqs.reduce((a, b) => a + b, 0) / freqs.length;
        return freqs.map((f, i) => ({
          number: i + 1,
          status: f > mean * 1.02 ? 'hot' : f < mean * 0.98 ? 'cold' : 'neutral',
          count: f
        }));
      }
      function renderHotColdNumbers(freqs) {
        hotColdMap = classifyHotColdNumbers(freqs);
        const el = document.getElementById('hotColdNumbers');
        el.innerHTML = hotColdMap.map(n => `
          <span class="number" style="background:${{
            hot: 'var(--hot-color)',
            cold: 'var(--cold-color)',
            neutral: 'var(--neutral-color)'
          }[n.status]}">${n.number}</span>`).join('');
      }
      function calculateTransitionMatrix(data) {
        transitionMatrix = Array(49).fill().map(() => Array(49).fill(0));
        data.forEach(e => {
          const nums = e.Lottozahl.map(n => parseInt(n)).sort((a, b) => a - b);
          for (let i = 0; i < nums.length - 1; i++) {
            const from = nums[i] - 1;
            const to = nums[i + 1] - 1;
            if (from >= 0 && to >= 0) transitionMatrix[from][to]++;
          }
        });
      }
      function calculateChiSquare(obs) {
        const total = obs.reduce((a, b) => a + b, 0);
        expectedFrequency = total / 49;
        chiSquareResult = obs.reduce((sum, o) => sum + ((o - expectedFrequency) ** 2) / expectedFrequency, 0);
      }
      function renderChiSquareResult() {
        const critical = 65.171;
        const significant = chiSquareResult > critical;
        const box = document.getElementById('chiSquareResult');
        box.className = `stat-box ${significant ? 'hot' : ''}`;
        box.innerHTML = `
          <h3>Chi-Quadrat-Test</h3>
          <p>Wert: ${chiSquareResult.toFixed(2)}</p>
          <p>Erwartet: ${expectedFrequency.toFixed(1)}</p>
          <p>Signifikanz: ${significant ? '⚠️ Abweichung' : '✅ Normal'}</p>
        `;
      }
      function getTopNumbers(freqs, count, isSuper = false) {
        return freqs.map((c, i) => ({ number: isSuper ? i : i + 1, count: c }))
                    .sort((a, b) => b.count - a.count)
                    .slice(0, count);
      }
      function calculateKIScores() {
        return Array.from({ length: 49 }, (_, i) => {
          const hotCold = hotColdMap[i] || { status: "neutral", count: 0 };
          const hotColdFactor = {
            hot: 1.1,
            cold: 0.85,
            neutral: 1.0
          }[hotCold.status];
          const transitions = Array.isArray(transitionMatrix[i]) ? transitionMatrix[i] : [];
          const transitionBonus = transitions.reduce((a, b) => a + b, 0) / 10;
          const chiFactor = chiSquareResult > 65 ? 1.1 : 1.0;
          const entropyFactor = 1.0;
          const f = hotCold.count || 0;
          return {
            number: i + 1,
            score: f * hotColdFactor * chiFactor * entropyFactor + transitionBonus
          };
        });
      }
      function renderKIVorhersage(freqs, entropy) {
        const scores = calculateKIScores();
        const top = scores.sort((a, b) => b.score - a.score).slice(0, 6);
        const el = document.getElementById('kiTopNumbers');
        el.innerHTML = top.map(n => `<span class="number">${n.number}</span>`).join('');
      }

      function ermittleDieterPrognose(basisEntries = allLottoEntries) {
        function defizitArray(entries) {
          const freq = Array(49).fill(0);
          entries.forEach(e => e.Lottozahl?.forEach(z => freq[parseInt(z) - 1]++));
          return freq;
        }
        const alle = basisEntries;
        const letzte1000 = basisEntries.slice(-1000);
        const letzte100  = basisEntries.slice(-100);
        const letzte25   = basisEntries.slice(-25);

        const ziehungen_all   = alle.length * 6;
        const ziehungen_1000  = letzte1000.length * 6;
        const ziehungen_100   = letzte100.length * 6;
        const ziehungen_25    = letzte25.length * 6;

        const def_all   = defizitArray(alle).map(c => ziehungen_all/49   - c);
        const def_1000  = defizitArray(letzte1000).map(c => ziehungen_1000/49 - c);
        const def_100   = defizitArray(letzte100).map(c => ziehungen_100/49   - c);
        const def_25    = defizitArray(letzte25).map(c => ziehungen_25/49     - c);

        const kombiScore = Array(49).fill(0).map((_, i) =>
          DIETER_WEIGHT_LONG  * def_all[i] +
          DIETER_WEIGHT_1000 * def_1000[i] +
          DIETER_WEIGHT_100  * def_100[i] +
          DIETER_WEIGHT_25   * def_25[i]
        );
        const kiScores = calculateKIScores();
        const bewertet = kombiScore.map((defi, i) => ({
          zahl: i + 1,
          score: defi * (kiScores[i]?.score || 1)
        }));
        const top6 = bewertet.sort((a, b) => b.score - a.score).slice(0, 6);
        return top6.map(e => e.zahl);
      }

      function renderFreqChart(freqs, id, label, max, isSuper = false) {
        const ctx = document.getElementById(id)?.getContext('2d');
        if (!ctx) return;
        if (chartInstances[id]) chartInstances[id].destroy();
        const labels = Array.from({ length: max }, (_, i) => isSuper ? i : i + 1);
        chartInstances[id] = new Chart(ctx, {
          type: 'bar',
          data: {
            labels,
            datasets: [{
              label, data: freqs,
              backgroundColor: '#4CAF50',
              borderColor: '#388E3C',
              borderWidth: 1
            }]
          },
          options: {
            responsive: true,
            plugins: { legend: { display: false } },
            scales: {
              y: { beginAtZero: true },
              x: { title: { display: true, text: label } }
            }
          }
        });
      }
      function renderTransitionHeatmap() {
        const ctx = document.getElementById('transitionHeatmap')?.getContext('2d');
        if (!ctx) return;
        if (chartInstances.transitionHeatmap) chartInstances.transitionHeatmap.destroy();
        const matrixData = transitionMatrix.flatMap((row, x) =>
          row.map((val, y) => ({ x, y, v: val }))
        );
        chartInstances.transitionHeatmap = new Chart(ctx, {
          type: 'matrix',
          data: {
            datasets: [{
              label: 'Heatmap',
              data: matrixData,
              width: 10,
              height: 10,
              backgroundColor: ctx => {
                const v = ctx.raw.v;
                const alpha = Math.min(v / 10, 0.9);
                return `rgba(255, 68, 68, ${alpha})`;
              }
            }]
          },
          options: {
            plugins: {
              tooltip: {
                callbacks: {
                  title: ctx => `Von ${ctx[0].raw.x + 1} zu ${ctx[0].raw.y + 1}`,
                  label: ctx => `Häufigkeit: ${ctx.raw.v}`
                }
              }
            }
          }
        });
      }
      function renderTopLottozahlen(arr) {
        const el = document.getElementById('topLottozahlenList');
        el.innerHTML = arr.map(n => `<span class="number">${n.number}</span>`).join('');
      }
      function renderTopSuperzahl(arr) {
        const el = document.getElementById('topSuperzahlList');
        el.innerHTML = arr.length
          ? `<span class="number superzahl-display">${arr[0].number}</span>`
          : "Keine Daten";
      }
      function getDatensatzSubset() {
        const select = document.getElementById('dataSubsetSelect');
        const value = select.value;
        if (value === 'all') return [...allLottoEntries];
        const count = parseInt(value);
        return allLottoEntries.slice(-count);
      }
      function performAnalysis() {
        updateDieterWeightsFromUI(); // Gewichte immer aktuell holen!
        const daten = getDatensatzSubset();
        const lottoFreqs = Array(49).fill(0);
        const superFreqs = Array(10).fill(0);
        const superStart = new Date(1991, 11, 7);

        daten.forEach(e => {
          if (Array.isArray(e.Lottozahl)) {
            e.Lottozahl.forEach(n => {
              const z = parseInt(n);
              if (z >= 1 && z <= 49) lottoFreqs[z - 1]++;
            });
          }
          if (e.Superzahl != null && e.date) {
            const [d, m, y] = e.date.split('.');
            const date = new Date(+y, m - 1, +d);
            if (date >= superStart) {
              const sz = parseInt(e.Superzahl);
              if (sz >= 0 && sz <= 9) superFreqs[sz]++;
            }
          }
        });

        const entropy = computeEntropy(lottoFreqs);
        renderHotColdNumbers(lottoFreqs);
        calculateTransitionMatrix(daten);
        calculateChiSquare(lottoFreqs);
        renderChiSquareResult();
        renderKIVorhersage(lottoFreqs, entropy);
        // Ausgabe der Dieter-Prognose im Hauptfenster
        const top6 = ermittleDieterPrognose(daten);
        const el = document.getElementById("dieterPrognoseList");
        el.innerHTML = top6.map(e => `<span class="number">${e}</span>`).join('');
        renderFreqChart(lottoFreqs, 'freqChart', 'Lottozahlen 1–49', 49);
        renderEntropyGauge(entropy);
        renderFreqChart(superFreqs, 'superzahlFreqChart', 'Superzahlen 0–9', 10, true);
        renderTopLottozahlen(getTopNumbers(lottoFreqs, 6));
        renderTopSuperzahl(getTopNumbers(superFreqs, 1, true));
        renderTransitionHeatmap();
      }
      function handleError(msg, err) {
        console.error(msg, err);
        alert(msg + err.message);
      }

      // NEU: Dieter-Prognose-Backtest (für die letzten 50 Ziehungen)
      function runDieterBacktest() {
        updateDieterWeightsFromUI();
        const N = 50;
        if (!allLottoEntries || allLottoEntries.length < N + 1000) {
          document.getElementById('dieterBacktestResults').innerHTML = "Nicht genug Daten für Backtest!";
          return;
        }
        let trefferStat = [0, 0, 0, 0, 0, 0, 0];
        let detailRows = "";
        for (let i = allLottoEntries.length - N; i < allLottoEntries.length; i++) {
          // Prognose auf Basis der davorliegenden Ziehungen (exklusive der aktuellen)
          const vergangene = allLottoEntries.slice(0, i);
          // Hot/Cold/Transition neu berechnen für diesen Datensatz
          const basisFreqs = Array(49).fill(0);
          vergangene.forEach(e => e.Lottozahl?.forEach(n => { const z = parseInt(n); if(z>=1 && z<=49) basisFreqs[z-1]++; }));
          hotColdMap = classifyHotColdNumbers(basisFreqs);
          calculateTransitionMatrix(vergangene);
          calculateChiSquare(basisFreqs);
          // Dieter-Prognose für diese Ziehung
          const prognose = ermittleDieterPrognose(vergangene);
          // Tatsächlich gezogene Zahlen:
          const gezogen = allLottoEntries[i].Lottozahl.map(Number);
          // Treffer zählen:
          let richtig = prognose.filter(z => gezogen.includes(z)).length;
          trefferStat[richtig]++;
          // Details für Tabelle:
          detailRows += `
            <tr>
              <td>${i+1}</td>
              <td>${gezogen.map(n=>`<span class="number">${n}</span>`).join(' ')}</td>
              <td>${prognose.map(n=>`<span class="number">${n}</span>`).join(' ')}</td>
              <td class="${richtig===0?'zero':'right'}">${richtig}</td>
            </tr>
          `;
        }
        // Ergebnis zusammenstellen:
        const trefferSchnitt = (trefferStat.reduce((s,c,i)=>s+c*i,0) / N).toFixed(2);
        let statZeile = "";
        for (let i = 0; i <= 6; i++) {
          statZeile += `<td>${trefferStat[i]}</td>`;
        }
        document.getElementById('dieterBacktestResults').innerHTML = `
          <strong>Durchschnittliche Trefferzahl pro Ziehung: ${trefferSchnitt}</strong>
          <br>
          <table>
            <tr>
              <th colspan="7">Häufigkeit der Treffer (0 bis 6 Richtige)</th>
            </tr>
            <tr>
              <th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th>
            </tr>
            <tr>${statZeile}</tr>
          </table>
          <details style="margin-top:8px;">
            <summary>Details zu jeder Ziehung anzeigen</summary>
            <table>
              <tr>
                <th>#</th>
                <th>Gezogen</th>
                <th>Prognose</th>
                <th>Richtig</th>
              </tr>
              ${detailRows}
            </table>
          </details>
        `;
      }
    </script>
  </div>
</body>
</html>
